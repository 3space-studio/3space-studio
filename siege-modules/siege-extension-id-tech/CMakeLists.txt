cmake_minimum_required(VERSION 3.20)
project(siege-extension-id-tech)

if (WIN32)
    add_library(siege-extension-quake SHARED src/quake.cpp src/id-tech-2.def)
    add_library(siege-extension-hexen-2 SHARED src/hexen-2.cpp src/id-tech-2.def)
    add_library(siege-extension-battle-metal SHARED src/battle-metal.cpp src/id-tech-2.def)
    add_library(siege-extension-quake-2 SHARED src/quake-2.cpp src/id-tech-2.5.def)
    #TODO finish the siege-installation logic for heretic 2 so that it is easy to extend
 #   add_library(siege-extension-heretic-2 SHARED src/sof.cpp src/id-tech-2.5.def)
    add_library(siege-extension-soldier-of-fortune SHARED src/sof.cpp src/id-tech-2.5.def)
    add_library(siege-extension-anachronox SHARED src/anox.cpp src/id-tech-2.5.def)
    add_library(siege-extension-daikatana SHARED src/daikatana.cpp src/id-tech-2.5.def)
    add_library(siege-extension-kingpin SHARED src/kingpin.cpp src/id-tech-2.5.def)
    add_library(siege-extension-sin SHARED src/sin.cpp src/id-tech-2.5.def)
    add_library(siege-extension-quake-3 SHARED src/quake-3.cpp src/id-tech-3.def)
    add_library(siege-extension-return-to-castle-wolf SHARED src/wolf.cpp src/id-tech-3.def)
    add_library(siege-extension-elite-force SHARED src/elite-force.cpp src/id-tech-3.def)
    add_library(siege-extension-elite-force-2 SHARED src/elite-force-2.cpp src/id-tech-3.def)
    add_library(siege-extension-jedi-outcast SHARED src/jedi-outcast.cpp src/id-tech-3.def)
    add_library(siege-extension-jedi-academy SHARED src/jedi-academy.cpp src/id-tech-3.def)
    add_library(siege-extension-soldier-of-fortune-2 SHARED src/sof-2.cpp src/id-tech-3.def)
    add_library(siege-extension-allied-assault SHARED src/allied-assault.cpp src/id-tech-3.def)
    add_library(siege-extension-call-of-duty SHARED src/call-of-duty.cpp src/id-tech-3.def)

    get_property(ID_TECH_TARGETS
                DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY BUILDSYSTEM_TARGETS)

    foreach(EXT_TARGET IN ITEMS ${ID_TECH_TARGETS})
        set_target_properties(${EXT_TARGET} PROPERTIES CXX_STANDARD 23)
        target_link_libraries(${EXT_TARGET} PRIVATE siege-extension)
    endforeach()
endif()
